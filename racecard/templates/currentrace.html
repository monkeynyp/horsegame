{% extends "master.html" %} {% block title %} Horse Racing Prediction By Machine Learning {% endblock %} {% block content %}
{% load i18n %}
{% load static %}
{% load custom_filters %}
<script>
  function updateSelection(checkbox) {
      var selectedCheckboxes = document.querySelectorAll('input[name="selected_horses"]:checked');

      if (selectedCheckboxes.length > 3) {
          checkbox.checked = false; // Uncheck the current checkbox if more than 3 are selected
      }

      // Disable unchecked checkboxes if 3 are selected
      var uncheckedCheckboxes = document.querySelectorAll('input[name="selected_horses"]:not(:checked)');
      uncheckedCheckboxes.forEach(function (uncheckedCheckbox) {
          uncheckedCheckbox.disabled = selectedCheckboxes.length >= 3;
      });
  }
</script>
<div class="w3-container w3-padding-64"></div>
<div class="w3-margin ">
    <h2>{% trans "Current Race" %}</h2>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '1' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=1">1</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '2' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=2">2</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '3' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=3">3</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '4' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=4">4</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '5' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=5">5</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '6' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=6">6</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '7' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=7">7</a>
        <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '8' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=8">8</a>
        {% if current_race.iloc.2.7 > 8 %}
          <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '9' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=9">9</a>
          {% if current_race.iloc.2.7 > 9 %}
            <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '10' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=10">10</a>
            {% if current_race.iloc.2.7 > 10 %}
              <a class="w3-button w3-xlarge w3-circle {% if request.GET.id == '11' %}w3-red{% else %}w3-black{% endif %}" href="/racecard/?id=11">11</a>
            {% endif %}
          {% endif %}
        {% endif %}
  </div>

  <!-- Add Tips by users-->
  <button onclick="document.getElementById('id01').style.display='block'" class="w3-button w3-green">Add Your Tips</button>
<!-- The Modal -->
<div id="id01" class="w3-modal">
  <div class="w3-modal-content">
    <div class="w3-center"><br>
      <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-xlarge w3-hover-red w3-display-topright" title="Close Modal">&times;</span>
      <img src="{% static 'Helpfultips.png' %}" alt="Avatar" style="width:10%" class="w3-circle">
      <h2>Race {{race_id}} Tips</h2>
    </div>

    <form method="post" action="{% url 'submit_tips' %}" class="w3-container w3-margin-left">
      {% csrf_token %}
      
      <h2>Select up to 3 horses:</h2>
  
      {% for i, r in current_race.iterrows %}
          <label>
            <input type="checkbox" name="selected_horses" value="{{ forloop.counter }}. {{ r.HorseName }}"
                   {% if r.HorseName in selected_horses %} checked {% endif %}
                   onclick="updateSelection(this)">
            {{ forloop.counter }}. {% trans r.HorseName %}
        </label><br>
      {% endfor %}
  
      <br>
      <button type="submit">Submit</button>
  </form>
  
  
    <div class="w3-container w3-border-top w3-padding-16 w3-light-grey">
      <button onclick="document.getElementById('id01').style.display='none'" type="button" class="w3-button w3-red">Cancel</button>
      <span class="w3-right w3-padding w3-hide-small">Forgot <a href="#">password?</a></span>
    </div>
  </div>
</div>

<div class="w3-row">
  <div class="w3-col w3-padding-top-32 w3-half w3-responsive">
    
    <table class="w3-table-all w3-card-4 w3-margin">
      <thead>
      <tr class="w3-light-blue">
        <th>No</th>
        <th>{% trans "Horse Name" %}</th>
        <th>{% trans "Jockey" %}</th>
        <th>{% trans "Draw" %}</th>
      </tr>
      </thead>
      {% for i, r in current_race.iterrows %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{% trans r.HorseName %}</td>
        <td>{% trans r.Jockey  %}</td>
        <td>{{ r.Draw }}</td>
      </tr>
      {% endfor %}
    </table>
  </div>

  <div class="w3-col w3-padding-top-32 w3-half w3-responsive" >
      <div class='w3-row'>
        <div class="w3-col w3-card-4 w3-margin w3-third" style="width: 33%">
          <header class="w3-container w3-green" >
            <h2>Naive Bayes <span class="w3-tag w3-xlarge w3-padding w3-red" style="transform:rotate(-5deg)">
              Race {{race_id}}
              </span></h2>
          </header>
          <div class="w3-container">
            <p>{% trans prediction.iloc.0.1 %} &nbsp {{prediction.iloc.0.2|floatformat:2}}</p>
            <p>{% trans prediction.iloc.1.1 %} &nbsp {{prediction.iloc.1.2|floatformat:2}}</p>
            <p>{% trans prediction.iloc.2.1 %} &nbsp {{prediction.iloc.2.2|floatformat:2}}</p>
            <p>{% trans prediction.iloc.3.1 %} &nbsp {{prediction.iloc.3.2|floatformat:2}}</p>
          </div>
          <footer class="w3-container w3-green">
            <h5>nyp.pythonanywhere.com</h5>
          </footer>
        </div>
    
        <div class="w3-col w3-card-4 w3-third w3-margin" style="width: 33%">
            <header class="w3-container w3-blue" >
              <h2>Log Reg <span class="w3-tag w3-xlarge w3-padding w3-red" style="transform:rotate(-5deg)">
              Race {{race_id}}
              </span></h2>
            </header>
          <div class="w3-container">
            <p>{% trans log_pred.iloc.0.1 %} &nbsp {{log_pred.iloc.0.2|floatformat:3}}</p>
            <p>{% trans log_pred.iloc.1.1 %} &nbsp {{log_pred.iloc.1.2|floatformat:3}}</p>
            <p>{% trans log_pred.iloc.2.1 %} &nbsp {{log_pred.iloc.2.2|floatformat:3}}</p>
            <p>{% trans log_pred.iloc.3.1 %} &nbsp {{log_pred.iloc.3.2|floatformat:3}}</p>
          </div>
          <footer class="w3-container w3-blue">
            <h5>nyp.pythonanywhere.com</h5>
          </footer>
      </div>
    </div>
  </div>
</div>
{% endblock %}
